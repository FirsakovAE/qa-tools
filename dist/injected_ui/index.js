import{c as h,_ as g,b as u}from"../assets/App.vue_vue_type_script_setup_true_lang-EXuAK4ze.js";class m{async get(s){try{return(await chrome.storage.local.get(s))[s]??null}catch{return null}}async set(s,e){try{await chrome.storage.local.set({[s]:e})}catch{}}async remove(s){try{await chrome.storage.local.remove(s)}catch{}}}const l="__VUE_INSPECTOR__";class p{id="extension";capabilities={hasBackgroundScript:!0,hasPopup:!0,canInspectOtherTabs:!0,hasPersistentStorage:!0,mode:"extension"};storage=new m;messageListeners=new Set;windowListener=null;pendingRequests=new Map;requestCounter=0;isIframe;constructor(){this.isIframe=window!==window.parent}getResourceURL(s){return chrome.runtime.getURL(s)}async sendMessage(s,e=5e3){return this.isIframe?this.sendViaPostMessage(s,e):this.sendViaChrome(s,e)}async sendViaPostMessage(s,e){return new Promise((t,n)=>{const r=`req_${++this.requestCounter}_${Date.now()}`,o=setTimeout(()=>{this.pendingRequests.delete(r),n(new Error("Message timeout"))},e);this.pendingRequests.set(r,{resolve:t,reject:n,timeout:o}),this.ensureWindowListener(),window.parent.postMessage({[l]:!0,requestId:r,message:s},"*")})}async sendViaChrome(s,e){return new Promise((t,n)=>{const r=setTimeout(()=>{n(new Error("Message timeout"))},e);chrome.tabs.query({active:!0,currentWindow:!0},o=>{if(!o[0]?.id){clearTimeout(r),n(new Error("No active tab"));return}chrome.tabs.sendMessage(o[0].id,s,d=>{clearTimeout(r),chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message)):t(d)})})})}onMessage(s){return this.messageListeners.add(s),this.isIframe?this.ensureWindowListener():this.ensureChromeListener(),()=>{this.messageListeners.delete(s),this.messageListeners.size===0&&this.pendingRequests.size===0&&(this.removeWindowListener(),this.removeChromeListener())}}ensureWindowListener(){this.windowListener||(this.windowListener=s=>{const e=s.data;if(!(!e||typeof e!="object")&&e[l]){if(e.responseId&&this.pendingRequests.has(e.responseId)){const t=this.pendingRequests.get(e.responseId);this.pendingRequests.delete(e.responseId),clearTimeout(t.timeout),e.error?t.reject(new Error(e.error)):t.resolve(e.response);return}if(e.broadcast&&e.message)for(const t of this.messageListeners)try{t(e.message,()=>{})}catch(n){console.error("[ExtensionAdapter] Message handler error:",n)}}},window.addEventListener("message",this.windowListener))}removeWindowListener(){this.windowListener&&(window.removeEventListener("message",this.windowListener),this.windowListener=null)}chromeListener=null;ensureChromeListener(){this.chromeListener||(this.chromeListener=(s,e,t)=>{let n=!1;for(const r of this.messageListeners)r(s,t)===!0&&(n=!0);return n},chrome.runtime.onMessage.addListener(this.chromeListener))}removeChromeListener(){this.chromeListener&&(chrome.runtime.onMessage.removeListener(this.chromeListener),this.chromeListener=null)}onReady(s){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s()}destroy(){this.removeWindowListener(),this.removeChromeListener();for(const{timeout:s,reject:e}of this.pendingRequests.values())clearTimeout(s),e(new Error("Adapter destroyed"));this.pendingRequests.clear(),this.messageListeners.clear()}}function w(){return new p}const a="__vue_inspector_storage__",c="__VUE_INSPECTOR__";class L{async get(s){try{const e=localStorage.getItem(a);return(e?JSON.parse(e):{})[s]??null}catch{return null}}async set(s,e){try{const t=localStorage.getItem(a),n=t?JSON.parse(t):{};n[s]=e,localStorage.setItem(a,JSON.stringify(n))}catch{}}async remove(s){try{const e=localStorage.getItem(a),t=e?JSON.parse(e):{};delete t[s],localStorage.setItem(a,JSON.stringify(t))}catch{}}}class f{id="standalone";capabilities={hasBackgroundScript:!1,hasPopup:!1,canInspectOtherTabs:!1,hasPersistentStorage:!0,mode:"standalone"};storage=new L;config;messageListeners=new Set;windowListener=null;pendingRequests=new Map;requestCounter=0;constructor(s){this.config={targetOrigin:"*",...s}}getResourceURL(s){return`${this.config.baseURL.replace(/\/$/,"")}/${s}`}async sendMessage(s,e=5e3){return new Promise((t,n)=>{try{const r=`req_${++this.requestCounter}_${Date.now()}`;console.log("[StandaloneAdapter] Sending message:",s.type,"requestId:",r);const o=setTimeout(()=>{console.log("[StandaloneAdapter] Message timeout:",s.type,r),this.pendingRequests.delete(r),n(new Error("Message timeout"))},e);this.pendingRequests.set(r,{resolve:t,reject:n,timeout:o}),this.ensureWindowListener();const d=this.config.targetWindow||window.parent;console.log("[StandaloneAdapter] Posting to target:",d===window.parent?"window.parent":"custom"),d.postMessage({[c]:!0,requestId:r,message:s},this.config.targetOrigin),console.log("[StandaloneAdapter] postMessage completed for:",s.type)}catch(r){console.error("[StandaloneAdapter] Error in sendMessage:",r),n(r)}})}onMessage(s){return this.messageListeners.add(s),this.ensureWindowListener(),()=>{this.messageListeners.delete(s),this.messageListeners.size===0&&this.pendingRequests.size===0&&this.removeWindowListener()}}onReady(s){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s()}destroy(){this.removeWindowListener();for(const{timeout:s,reject:e}of this.pendingRequests.values())clearTimeout(s),e(new Error("Adapter destroyed"));this.pendingRequests.clear(),this.messageListeners.clear()}ensureWindowListener(){this.windowListener||(this.windowListener=s=>{const e=s.data;if(!(!e||typeof e!="object")&&e[c]){if(console.log("[StandaloneAdapter] Received message with prefix, responseId:",e.responseId,"hasPending:",this.pendingRequests.has(e.responseId)),e.responseId&&this.pendingRequests.has(e.responseId)){const t=this.pendingRequests.get(e.responseId);this.pendingRequests.delete(e.responseId),clearTimeout(t.timeout),console.log("[StandaloneAdapter] Resolving request:",e.responseId,"response:",e.response),e.error?t.reject(new Error(e.error)):t.resolve(e.response);return}if(e.broadcast){for(const t of this.messageListeners)try{t(e.message,()=>{})}catch(n){console.error("[Standalone] Message handler error:",n)}return}if(e.requestId&&e.message){const t=n=>{const r=s.source;r&&r.postMessage({[c]:!0,responseId:e.requestId,response:n},this.config.targetOrigin)};for(const n of this.messageListeners)try{if(n(e.message,t)===!0)return}catch(r){console.error("[Standalone] Message handler error:",r)}}}},window.addEventListener("message",this.windowListener))}removeWindowListener(){this.windowListener&&(window.removeEventListener("message",this.windowListener),this.windowListener=null)}}function S(i){return new f(i)}function R(){const s=window.location.hash.match(/standalone=([^&]+)/);let e=!1,t="";if(s)e=!0,t=decodeURIComponent(s[1]);else try{e=!!window.parent?.__VUE_INSPECTOR_STANDALONE__,t=window.parent?.__VUE_INSPECTOR_BASE_URL__||""}catch{}if(e){const n=S({baseURL:t,targetWindow:window.parent});u(n),console.log("[Vue Inspector] Standalone mode initialized, baseURL:",t)}else{const n=w();u(n),console.log("[Vue Inspector] Extension mode initialized")}}R();h(g).mount("#app");
